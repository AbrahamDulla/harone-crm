<!DOCTYPE html>
<html>
  <head>
    <title>Dashboard</title>
    <link
      rel="stylesheet"
      href="https://stackpath.bootstrapcdn.com/bootstrap/4.5.2/css/bootstrap.min.css"
    />
    <style>
      .sidebar {
        background-color: #222b40;
        color: white;
        height: 100vh;
      }
      .disabled-link {
        pointer-events: none;
        cursor: not-allowed;
        opacity: 0.6;
      }
      .nav-link {
        color: rgb(148, 148, 148);
      }
      .nav-link.active {
        color: rgb(24, 149, 245);
      }
      .nav-link:hover {
        cursor: pointer;
      }
      .main-container {
        padding: 20px;
      }
      .nav-row {
        height: 50px;
        margin-bottom: 10px;
      }
      .content {
        display: none;
      }
    </style>
  </head>
  <body>
    <div class="container-fluid">
      <div class="row">
        <div class="col-2 sidebar">
          <h4 style="margin-top: 60px">HARONE CRM</h4>
          <ul class="nav flex-column mt-5">
            <li class="nav-item">
              <a class="nav-link" data-content="content1">Dashboard</a>
            </li>
            <!-- ... other nav items ... -->
            <li class="nav-item">
              <a class="nav-link" data-content="content6">Clients</a>
            </li>
            <li class="nav-item">
              <a class="nav-link" data-content="content7">Onboard screen</a>
            </li>
          </ul>
        </div>
        <div class="col-10 main-container">
          <div id="content1" class="content">
            <div class="container mt-3">
              <div
                class="mb-5"
                style="
                  background-color: #a0a8c0;
                  color: aliceblue;
                  height: 60px;
                  display: flex;
                  align-items: center;
                "
              ></div>
            </div>
            <div class="container mt-4">
              <div class="row">
                <div class="col-md-3">
                  <div
                    class="card"
                    style="
                      height: 120px;
                      background-color: #929bad;
                      color: aliceblue;
                      display: flex;
                      justify-content: center;
                      align-items: center;
                    "
                  >
                    <label>Column 1</label>
                  </div>
                </div>
                <div class="col-md-3">
                  <div
                    class="card"
                    style="
                      height: 120px;
                      background-color: #929bad;
                      color: aliceblue;
                      display: flex;
                      justify-content: center;
                      align-items: center;
                    "
                  >
                    <label>Column 1</label>
                  </div>
                </div>
                <div class="col-md-3">
                  <div
                    class="card"
                    style="
                      height: 120px;
                      background-color: #929bad;
                      color: aliceblue;
                      display: flex;
                      justify-content: center;
                      align-items: center;
                    "
                  >
                    <label>Column 1</label>
                  </div>
                </div>
                <div class="col-md-3">
                  <div
                    class="card"
                    style="
                      height: 120px;
                      background-color: #929bad;
                      color: aliceblue;
                      display: flex;
                      justify-content: center;
                      align-items: center;
                    "
                  >
                    <label>Column 1</label>
                  </div>
                </div>
              </div>

              <div class="row mt-4">
                <div class="col-md-4">
                  <div
                    class="card"
                    style="
                      height: 230px;
                      background-color: #929bad;
                      color: aliceblue;
                      display: flex;
                      justify-content: center;
                      align-items: center;
                    "
                  >
                    <label>Column 1</label>
                  </div>
                </div>
                <div class="col-md-4">
                  <div
                    class="card"
                    style="
                      height: 230px;
                      background-color: #929bad;
                      color: aliceblue;
                      display: flex;
                      justify-content: center;
                      align-items: center;
                    "
                  >
                    <label>Column 1</label>
                  </div>
                </div>
                <div class="col-md-4">
                  <div
                    class="card"
                    style="
                      height: 230px;
                      background-color: #929bad;
                      color: aliceblue;
                      display: flex;
                      justify-content: center;
                      align-items: center;
                    "
                  >
                    <label>Column 1</label>
                  </div>
                </div>
              </div>
            </div>
          </div>
          <div id="content6" class="content">
            <div class="container mt-3">
              <div
                class="mb-5"
                style="
                  background-color: #a0a8c0;
                  color: aliceblue;
                  height: 60px;
                  display: flex;
                  align-items: center;
                "
              >
                <h4 class="ml-2">Clients</h4>
              </div>
              <table class="table">
                <thead>
                  <tr>
                    <th>Company Name</th>
                    <th>Email</th>
                    <th>Business Address</th>
                    <th>Industry</th>
                  </tr>
                </thead>
                <tbody>
                  {% for client in clients %}
                  <tr>
                    <td>{{ client.company_name }}</td>
                    <td>{{ client.company_email }}</td>
                    <td>{{ client.business_address }}</td>
                    <td>{{ client.industry }}</td>
                  </tr>
                  {% endfor %}
                </tbody>
              </table>
              <nav aria-label="Page navigation">
                <ul class="pagination" id="clientsPagination">
                  <!-- Client pagination items will be added dynamically here -->
                </ul>
              </nav>
            </div>
          </div>
          <div id="content7" class="content">
            <div class="container mt-3">
              <div
                class="mb-5"
                style="
                  background-color: #a0a8c0;
                  color: aliceblue;
                  height: 60px;
                  display: flex;
                  align-items: center;
                "
              >
                <h4 class="ml-2">Onboard request</h4>
              </div>
              <div id="approvalMessage"></div>
              <table class="table">
                <thead>
                  <tr>
                    <th>Company Name</th>
                    <th>Email</th>
                    <th>Business Address</th>
                    <th>Industry</th>
                    <th>Action</th>
                  </tr>
                </thead>
                <tbody id="customerTableBody">
                  {% for customer in customers %}
                  <tr>
                    <td>{{ customer.company_name }}</td>
                    <td>{{ customer.company_email }}</td>
                    <td>{{ customer.business_address }}</td>
                    <td>{{ customer.industry }}</td>
                    <td>
                      <form
                        onsubmit="approveCustomer(event, this, {{ customer.id }})"
                      >
                        <input
                          type="hidden"
                          name="customer_id"
                          value="{{ customer.id }}"
                        />
                        <button type="submit" class="btn btn-success btn-sm">
                          Approve
                        </button>
                      </form>
                    </td>
                  </tr>
                  {% endfor %}
                </tbody>
              </table>
              <nav aria-label="Page navigation">
                <ul class="pagination" id="customersPagination">
                  <!-- Customer pagination items will be added dynamically here -->
                </ul>
              </nav>
            </div>
          </div>
        </div>
      </div>
    </div>

    <script>
      document.addEventListener("DOMContentLoaded", function () {
        const navLinks = document.querySelectorAll(".nav-link");
        const contents = document.querySelectorAll(".content");

        navLinks.forEach(function (link) {
          link.addEventListener("click", function (e) {
            e.preventDefault();
            const contentId = this.getAttribute("data-content");

            navLinks.forEach((navLink) => navLink.classList.remove("active"));
            this.classList.add("active");
            contents.forEach((content) => (content.style.display = "none"));
            document.getElementById(contentId).style.display = "block";
          });
        });

        function setupPagination(
          items,
          pageSize,
          paginationUlId,
          renderPageFunction
        ) {
          const totalPages = Math.ceil(items.length / pageSize);
          const paginationUl = document.getElementById(paginationUlId);
          paginationUl.innerHTML = "";

          for (let i = 1; i <= totalPages; i++) {
            const li = document.createElement("li");
            li.className = "page-item";
            const a = document.createElement("a");
            a.href = "#";
            a.innerText = i;
            a.className = "page-link";
            a.addEventListener("click", (e) => {
              e.preventDefault();
              renderPageFunction(i);
            });
            li.appendChild(a);
            paginationUl.appendChild(li);
          }
        }

        function renderClientsPage(page) {
          const clients = Array.from(
            document.querySelectorAll("#content6 tbody tr")
          );
          const start = (page - 1) * 6;
          const end = start + 6;
          clients.forEach((client, index) => {
            client.style.display = index >= start && index < end ? "" : "none";
          });
        }

        function renderCustomersPage(page) {
          const customers = Array.from(
            document.querySelectorAll("#customerTableBody tr")
          );
          const start = (page - 1) * 6;
          const end = start + 6;
          customers.forEach((customer, index) => {
            customer.style.display =
              index >= start && index < end ? "" : "none";
          });
        }

        const clients = Array.from(
          document.querySelectorAll("#content6 tbody tr")
        );
        setupPagination(clients, 6, "clientsPagination", renderClientsPage);

        const customers = Array.from(
          document.querySelectorAll("#customerTableBody tr")
        );
        setupPagination(
          customers,
          6,
          "customersPagination",
          renderCustomersPage
        );

        renderClientsPage(1);
        renderCustomersPage(1);
      });

      function approveCustomer(event, form, customerId) {
        event.preventDefault();

        fetch("/customer/approve", {
          method: "POST",
          body: new FormData(form),
        })
          .then((response) => response.json())
          .then((data) => {
            document.getElementById("approvalMessage").innerText =
              "Customer approved successfully";
          })
          .catch((error) => {
            document.getElementById("approvalMessage").innerText =
              "Error approving customer";
            console.error("Error:", error);
          });
      }

      document.addEventListener("DOMContentLoaded", function () {
        const dashboardLink = document.querySelector(
          '.nav-link[data-content="content1"]'
        );
        if (dashboardLink) {
          dashboardLink.click();
        }
      });
    </script>
  </body>
</html>
